### Clean Architecture

#### 05부 아키텍처

#### 20장. 업무 규칙

애플리케이션을 업무 규칙과 플러그인으로 구분하려면 업무 규칙이 무엇인지 이해해야 함
업무 규칙은 **사업적**으로 수익을 얻거나 비용을 줄일 수 있는 규칙 또는 절차로, 구현 방식과는 상관 없음

핵심 업무 규칙과 핵심 업무 데이터는 본질적으로 결합되어 있어 객체로 만들기 좋은 후보가 됨
→ 엔티티(Entity)

---

##### 엔티티

컴퓨터 시스템 내부의 객체
핵심 업무 데이터를 기반으로 동작하는 일련의 조그만 핵심 업무 규칙

핵심 업무 데이터를 직접 포함하거나 핵심 업무 데이터에 쉽게 접근할 수 있음

엔티티의 인터페이스는 핵심 업무 데이터를 기반으로 동작하는 핵심 업무 규칙을 구현한 함수들로 이루어짐
엔티티는 업무에 관한 것이며 이외의 것이 포함되면 안됨

---

##### 유스케이스

모든 업무 규칙이 엔티티처럼 순수하게 업무 자체에만 연관된 것은 아님
자동화된 시스템의 동작 방식 등의 업무 규칙 등은 시스템의 한 부분으로 존재해야만 의미가 있으므로 수동 환경에선 존재할 수 X

**유스케이스**는 사용자가 제공해야하는 입력, 보여줄 출력, 출력의 처리 단계 등으로 **애플리케이션에 특화된 업무 규칙**
유스케이스는 엔티티 내부의 핵심 업무 규칙을 어떻게, 언제 호출할지를 명시하는 규칙
엔티티를 어떻게 사용할 지에 대해서 유스케이스가 제어하는 것

유스케이스는 인터페이스에서 오가는 데이터들을 형식없이 명시할 뿐, 사용자 인터페이스를 기술하지 않음
사용자에게 어떻게 보여지는 지가 아니라 사용자와 엔티티 사이의 상호작용을 규정지음

유스케이스는 객체이며, 애플리케이션에 특화된 업무 규칙을 구현하는 하나 이상의 함수를 제공함
입/출력 데이터, 엔티티에 대한 참조 데이터 등의 데이터 요소도 포함되어 있음

엔티티는 유스케이스에 대해 알지 못하며,  DI의 또 다른 예시임
엔티티와 같은 고수준 개념은 유스케이스와 같은 저수준 개념에 대해서는 알지 못함
유스케이스는 단일 애플리케이션에 특화되어 있으며 해당 시스템의 입/출력에 보다 가까움 → 저수준
엔티티는 다양한 애플리케이션에서 사용할 수 있도록 일반화되어 있음 → 고수준

---

##### 요청 및 응답 모델

**제대로 구성된 유스케이스 객체라면 데이터를 주고받는 방식에 대해서는 몰라야 함**
요청 데이터를 입력으로 받고 응답 데이터를 출력으로 반환할 뿐, 어떤 것에도 의존해서는 안됨
(표준 프레임워크나 웹 인터페이스에 종속해선 안됨)

요청 및 응답 모델이 독립적이지 않다면, 이 모델에 의존하는 유스케이스도 해당 모델이 갖는 의존성에 간접적으로 결합되어 버림

엔티티와 요청/응답 모델은 상당히 많은 데이터를 공유하므로 엔티티에 대한 참조를 요청/응답 데이터 구조에 포함시키고 싶을 수도 있지만 이들 두 객체의 목적은 완전히 다름
두 객체는 변경되는 이유가 다를 것이기 때문에, OCP, SRP를 위배하게 됨

---

##### 결론

업무 규칙은 사용자 인터페이스나 DB 등의 저수준 관심사로 오염되어서는 안됨
시스템에서 가장 독립적이고 가장 많이 재사용할 수 있는 코드여야 함