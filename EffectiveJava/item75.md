## Effective Java 3/E

#### Item 75. 예외의 상세 메시지에 실패 관련 정보를 담으라

- 예외를 잡지 못해 프로그램이 실패하면 stack trace를 자동으로 출력함

  > 예외 객체의 toString을 호출해 얻는 문자열로 보통 {예외 클래스 이름+상세 메시지}

- 사후 분석을 위해 실패 순간의 상황을 정확히 포착해 상세 메시지에 담아야 함

-----

###### 실패 순간 포착

- 실패 순간을 포착하려면 발생한 예외에 관여된 모든 매개변수와 필드의 값을 실패 메시지에 담아야 함

  > IndexOutOfBoundException의 상세 메시지는 범위의 최솟값, 최댓값, 범위를 벗어난 인덱스 값을 담아야 함

- **보안과 관련된 정보는 주의해서 담아야 함**

  문제를 진단하는 과정에 여러 사람에게 노출되기 때문에 상세 메시지에 암호 같은 정보가 노출되선 안됨

----

###### 예외 메시지

- 문제를 분석하는 사람은 스택 추적 뿐만 아니라 문서 및 소스코드를 함께 살펴보기 때문에 중복된 정보는 제공할 필요 없음
- 예외 상세 메시지와 사용자에게 보여줄 오류 메시지를 혼동해선 안됨
  - 사용자에게는 친절한 안내 메시지를 제공
  - 예외 메시지는 가독성보다는 담긴 내용이 중요함
- 예외 생성자에서 필요한 정보를 받아서 상세 메시지를 미리 생성해놓는 방법도 좋음

```java
	public IndexOutOfBoundException(int lowerBound, int upperBound,
											int index) {
		super(String.format("Lower: %d, Upper: %d, Index: %d",
				lowerBound, upperBound, index)); // 메시지를 생성
		
		this.lowerBound = lowerBound;
		this.upperBound = upperBound;
		this.index = index;
	}
```

- 생성자에서 메시지를 만들어줄 경우 실패를 더 잘 포착할 수 있고, 클래스 사용자가 메시지를 만드는 작업을 중복하지 않아도 됨

- 실패 정보는 예외 상황을 복구하는 데 유용할 수 있으므로, 비검사 예외보다는 검사 예외에서 더 유용
- 하지만 toString이 반환된 값에 포함된 정보를 얻어올 수 있는 API를 제공하자는 일반원칙을 따르기 위해 비검사 예외라도 상세 정보를 알려주는 접근자 메서드를 제공하는 것이 좋음